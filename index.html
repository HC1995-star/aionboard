<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tradedoubler Onboarding Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .chat-message {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .pulse-loader {
            animation: pulse 1.5s ease-in-out infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-50">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="w-96 bg-white shadow-lg p-6 overflow-y-auto">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Tradedoubler</h2>
                <p class="text-sm text-gray-600">AI Onboarding Assistant</p>
            </div>

            <!-- Progress bar -->
            <div class="mb-6">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-sm font-medium text-gray-700">Progress</span>
                    <span id="progress-percentage" class="text-sm font-medium text-blue-600">0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>

            <!-- API Status -->
            <div id="api-status" class="hidden mb-6 p-3 rounded-lg">
                <div class="flex items-center gap-2">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                    </svg>
                    <span id="api-status-text" class="text-sm font-medium"></span>
                </div>
            </div>

            <!-- Checklist -->
            <div class="space-y-3 mb-6">
                <h3 class="text-sm font-semibold text-gray-700 mb-3">Onboarding Checklist</h3>
                
                <div id="checklist-intro" class="checklist-item flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" stroke-width="2"/>
                    </svg>
                    <span class="text-sm text-gray-500">Introduction & Details</span>
                </div>

                <div id="checklist-brandedTracking" class="checklist-item flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" stroke-width="2"/>
                    </svg>
                    <span class="text-sm text-gray-500">DNS Configuration</span>
                </div>

                <div id="checklist-productFeed" class="checklist-item flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" stroke-width="2"/>
                    </svg>
                    <span class="text-sm text-gray-500">Product Feed</span>
                </div>

                <div id="checklist-assets" class="checklist-item flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" stroke-width="2"/>
                    </svg>
                    <span class="text-sm text-gray-500">Logos & Banners</span>
                </div>

                <div id="checklist-ipAddresses" class="checklist-item flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" stroke-width="2"/>
                    </svg>
                    <span class="text-sm text-gray-500">Office IP Addresses</span>
                </div>

                <div id="checklist-trackingScripts" class="checklist-item flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" stroke-width="2"/>
                    </svg>
                    <span class="text-sm text-gray-500">Tracking Scripts</span>
                </div>
            </div>

            <!-- File Upload Sections - ORGANIZED BY TYPE -->
            <div class="space-y-4 border-t border-gray-200 pt-6">
                <h3 class="text-sm font-semibold text-gray-700 mb-4">Upload Program Assets</h3>

                <!-- Logo Upload -->
                <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-xs font-medium text-gray-700">Logo</h4>
                        <span class="text-xs text-gray-500">350x130px</span>
                    </div>
                    <button onclick="document.getElementById('logo-input').click()" class="w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-xs">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        Upload Logo
                    </button>
                    <input type="file" id="logo-input" accept=".png,.jpg,.jpeg" class="hidden">
                    <div id="logo-list" class="mt-2 space-y-1"></div>
                </div>

                <!-- Banners Upload -->
                <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-xs font-medium text-gray-700">Banners</h4>
                        <span class="text-xs text-gray-500">Multiple</span>
                    </div>
                    <p class="text-xs text-gray-400 mb-2">160x600, 300x250, 300x600, 728x90, 928x70</p>
                    <button onclick="document.getElementById('banners-input').click()" class="w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-xs">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        Upload Banners
                    </button>
                    <input type="file" id="banners-input" accept=".jpg,.jpeg,.gif,.png" multiple class="hidden">
                    <div id="banners-list" class="mt-2 space-y-1"></div>
                </div>

                <!-- Terms & Conditions -->
                <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-xs font-medium text-gray-700">Terms & Conditions</h4>
                        <span class="text-xs text-gray-500">PDF</span>
                    </div>
                    <button onclick="document.getElementById('terms-input').click()" class="w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-xs">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        Upload T&Cs
                    </button>
                    <input type="file" id="terms-input" accept=".pdf" class="hidden">
                    <div id="terms-list" class="mt-2 space-y-1"></div>
                </div>

                <!-- Other Documents -->
                <div class="bg-gray-50 rounded-lg p-3 border border-gray-200">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="text-xs font-medium text-gray-700">Other Documents</h4>
                        <span class="text-xs text-gray-500">Optional</span>
                    </div>
                    <button onclick="document.getElementById('other-input').click()" class="w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-xs">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                        </svg>
                        Upload Files
                    </button>
                    <input type="file" id="other-input" multiple class="hidden">
                    <div id="other-list" class="mt-2 space-y-1"></div>
                </div>

                <!-- Send All Button -->
                <button id="send-all-files" class="w-full px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium shadow-md disabled:bg-gray-300 disabled:cursor-not-allowed" disabled>
                    Send All Files
                </button>
            </div>

            <!-- Collected Data Summary -->
            <div class="mt-6 pt-6 border-t border-gray-200">
                <h3 class="text-sm font-semibold text-gray-700 mb-3">Collected Data</h3>
                <div id="data-summary" class="text-xs text-gray-600 space-y-1">
                    <p>No data collected yet</p>
                </div>
            </div>
        </div>

        <!-- Chat area -->
        <div class="flex-1 flex flex-col">
            <!-- Chat messages -->
            <div id="chat-container" class="flex-1 overflow-y-auto p-6 space-y-4">
                <!-- Initial message -->
                <div class="flex justify-start">
                    <div class="max-w-2xl rounded-2xl px-4 py-3 bg-white shadow-md text-gray-800 chat-message">
                        <p class="mb-2">Hi! üëã I'm your Tradedoubler onboarding assistant.</p>
                        <p class="mb-3">I'll help you configure your affiliate program by setting up:</p>
                        <ul class="space-y-1 ml-4 mb-3">
                            <li>‚Ä¢ <strong>DNS Configuration</strong> - I'll verify your branded tracking domains</li>
                            <li>‚Ä¢ <strong>Product Feed</strong> - I'll process and map your products automatically</li>
                            <li>‚Ä¢ <strong>Program Assets</strong> - Upload logos, banners, and T&Cs in organized folders</li>
                        </ul>
                        <p><strong>Let's get started! What's your name and company?</strong></p>
                    </div>
                </div>
            </div>

            <!-- Input area -->
            <div class="border-t border-gray-200 bg-white p-4">
                <div class="max-w-4xl mx-auto flex gap-3">
                    <input
                        type="text"
                        id="message-input"
                        placeholder="Type your message..."
                        class="flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    />
                    <button
                        id="send-btn"
                        class="px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center gap-2"
                    >
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const N8N_WEBHOOK_URL = 'https://coe-n8n.common-eu-de.services.tddrift.net/webhook/onboarding-chat';
        // ============================================

        // State management - FILES NOW ORGANIZED BY CATEGORY
        let conversationHistory = [];
        let onboardingData = {};
        let checklist = {
            intro: false,
            brandedTracking: false,
            productFeed: false,
            assets: false,
            ipAddresses: false,
            trackingScripts: false
        };
        
        // ORGANIZED FILE STORAGE BY TYPE
        let uploadedFiles = {
            logo: [],
            banners: [],
            terms: [],
            other: []
        };
        
        let sessionId = generateSessionId();

        // DOM elements
        const chatContainer = document.getElementById('chat-container');
        const messageInput = document.getElementById('message-input');
        const sendBtn = document.getElementById('send-btn');
        const sendAllFilesBtn = document.getElementById('send-all-files');
        const dataSummary = document.getElementById('data-summary');
        const apiStatus = document.getElementById('api-status');
        const apiStatusText = document.getElementById('api-status-text');

        // File inputs
        const logoInput = document.getElementById('logo-input');
        const bannersInput = document.getElementById('banners-input');
        const termsInput = document.getElementById('terms-input');
        const otherInput = document.getElementById('other-input');

        // Initialize
        conversationHistory.push({
            role: 'assistant',
            content: "Hi! üëã I'm your Tradedoubler onboarding assistant.\n\nI'll help you configure your affiliate program with organized asset uploads.\n\nLet's get started! What's your name and company?"
        });

        // Event listeners
        sendBtn.addEventListener('click', sendMessage);
        messageInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        // File upload listeners for each category
        logoInput.addEventListener('change', (e) => handleFileUpload(e, 'logo', 'logo-list'));
        bannersInput.addEventListener('change', (e) => handleFileUpload(e, 'banners', 'banners-list'));
        termsInput.addEventListener('change', (e) => handleFileUpload(e, 'terms', 'terms-list'));
        otherInput.addEventListener('change', (e) => handleFileUpload(e, 'other', 'other-list'));
        
        sendAllFilesBtn.addEventListener('click', sendAllFiles);

        // Functions
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message || sendBtn.disabled) return;

            messageInput.disabled = true;
            sendBtn.disabled = true;

            addMessageToChat('user', message);
            conversationHistory.push({ role: 'user', content: message });
            messageInput.value = '';

            const loadingId = addLoadingIndicator();

            try {
                const response = await fetch(N8N_WEBHOOK_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        sessionId: sessionId,
                        message: message,
                        conversationHistory: conversationHistory,
                        onboardingData: onboardingData,
                        checklist: checklist,
                        uploadedFiles: uploadedFiles // Organized by category
                    })
                });

                const data = await response.json();

                removeLoadingIndicator(loadingId);

                addMessageToChat('assistant', data.response);
                conversationHistory.push({ role: 'assistant', content: data.response });

                if (data.onboardingData) {
                    onboardingData = data.onboardingData;
                    updateDataSummary();
                    
                    // Show API status
                    if (onboardingData.dnsVerified !== undefined) {
                        showApiStatus(onboardingData.dnsVerified ? 'success' : 'error', 
                                     onboardingData.dnsVerified ? 'DNS Verified!' : 'DNS Verification Failed');
                    }
                    if (onboardingData.feedProcessed !== undefined) {
                        showApiStatus(onboardingData.feedProcessed ? 'success' : 'error',
                                     onboardingData.feedProcessed ? `Feed Processed (${onboardingData.feedProductCount} products)` : 'Feed Processing Failed');
                    }
                    if (onboardingData.filesUploaded !== undefined) {
                        showApiStatus(onboardingData.filesUploaded ? 'success' : 'error',
                                     onboardingData.filesUploaded ? 'All Files Uploaded!' : 'File Upload Failed');
                        if (onboardingData.filesUploaded) {
                            // Clear all files after successful upload
                            uploadedFiles = { logo: [], banners: [], terms: [], other: [] };
                            clearAllFileLists();
                            updateSendAllButton();
                        }
                    }
                }
                if (data.checklist) {
                    checklist = data.checklist;
                    updateChecklist(data.checklist);
                }

            } catch (error) {
                console.error('Error:', error);
                removeLoadingIndicator(loadingId);
                addMessageToChat('assistant', 'I apologize, but I encountered an error. Please try again.');
            } finally {
                messageInput.disabled = false;
                sendBtn.disabled = false;
                messageInput.focus();
            }
        }

        function handleFileUpload(event, category, listId) {
            const files = Array.from(event.target.files);
            if (files.length === 0) return;

            const listElement = document.getElementById(listId);

            files.forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedFiles[category].push({
                        name: file.name,
                        type: file.type,
                        size: file.size,
                        data: e.target.result.split(',')[1],
                        category: category // Tag with category
                    });
                    
                    // Add to UI list
                    const fileDiv = document.createElement('div');
                    fileDiv.className = 'text-xs text-gray-600 flex items-center gap-2 p-1.5 bg-white rounded border border-gray-200';
                    fileDiv.innerHTML = `
                        <svg class="w-3 h-3 text-green-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                        <span class="flex-1 truncate text-xs">${file.name}</span>
                        <button onclick="removeFile('${category}', '${file.name}')" class="text-red-500 hover:text-red-700">
                            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    `;
                    listElement.appendChild(fileDiv);
                    
                    updateSendAllButton();
                };
                reader.readAsDataURL(file);
            });

            // Clear input
            event.target.value = '';
        }

        function removeFile(category, fileName) {
            uploadedFiles[category] = uploadedFiles[category].filter(f => f.name !== fileName);
            updateFileLists();
            updateSendAllButton();
        }

        function updateFileLists() {
            const lists = {
                logo: 'logo-list',
                banners: 'banners-list',
                terms: 'terms-list',
                other: 'other-list'
            };

            Object.keys(lists).forEach(category => {
                const listElement = document.getElementById(lists[category]);
                listElement.innerHTML = '';
                
                uploadedFiles[category].forEach(file => {
                    const fileDiv = document.createElement('div');
                    fileDiv.className = 'text-xs text-gray-600 flex items-center gap-2 p-1.5 bg-white rounded border border-gray-200';
                    fileDiv.innerHTML = `
                        <svg class="w-3 h-3 text-green-500 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                        <span class="flex-1 truncate text-xs">${file.name}</span>
                        <button onclick="removeFile('${category}', '${file.name}')" class="text-red-500 hover:text-red-700">
                            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    `;
                    listElement.appendChild(fileDiv);
                });
            });
        }

        function clearAllFileLists() {
            document.getElementById('logo-list').innerHTML = '';
            document.getElementById('banners-list').innerHTML = '';
            document.getElementById('terms-list').innerHTML = '';
            document.getElementById('other-list').innerHTML = '';
        }

        function updateSendAllButton() {
            const totalFiles = Object.values(uploadedFiles).reduce((sum, arr) => sum + arr.length, 0);
            sendAllFilesBtn.disabled = totalFiles === 0;
            sendAllFilesBtn.textContent = totalFiles > 0 ? `Send All Files (${totalFiles})` : 'Send All Files';
        }

        async function sendAllFiles() {
            const totalFiles = Object.values(uploadedFiles).reduce((sum, arr) => sum + arr.length, 0);
            if (totalFiles === 0) return;

            const filesSummary = Object.entries(uploadedFiles)
                .filter(([_, files]) => files.length > 0)
                .map(([category, files]) => `${category}: ${files.length} file(s)`)
                .join(', ');

            messageInput.value = `I'm uploading ${totalFiles} files: ${filesSummary}`;
            await sendMessage();
        }

        function addMessageToChat(role, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'}`;
            
            const bubble = document.createElement('div');
            bubble.className = `max-w-2xl rounded-2xl px-4 py-3 chat-message ${
                role === 'user' 
                    ? 'bg-blue-600 text-white' 
                    : 'bg-white shadow-md text-gray-800'
            }`;
            
            const formattedContent = content.split('\n').map(line => {
                if (line.startsWith('‚Ä¢') || line.startsWith('-')) {
                    return `<p class="ml-4">${line}</p>`;
                } else if (line.startsWith('‚úì') || line.startsWith('‚ö†Ô∏è')) {
                    return `<p class="font-medium ${line.startsWith('‚úì') ? 'text-green-600' : 'text-orange-600'}">${line}</p>`;
                }
                return line ? `<p class="mb-1">${line}</p>` : '<p class="mb-1"></p>';
            }).join('');
            
            bubble.innerHTML = formattedContent;
            messageDiv.appendChild(bubble);
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function addLoadingIndicator() {
            const loadingId = 'loading_' + Date.now();
            const messageDiv = document.createElement('div');
            messageDiv.id = loadingId;
            messageDiv.className = 'flex justify-start';
            
            const bubble = document.createElement('div');
            bubble.className = 'bg-white shadow-md rounded-2xl px-4 py-3';
            bubble.innerHTML = `
                <div class="flex gap-1">
                    <div class="w-2 h-2 bg-blue-600 rounded-full pulse-loader"></div>
                    <div class="w-2 h-2 bg-blue-600 rounded-full pulse-loader" style="animation-delay: 0.2s"></div>
                    <div class="w-2 h-2 bg-blue-600 rounded-full pulse-loader" style="animation-delay: 0.4s"></div>
                </div>
            `;
            
            messageDiv.appendChild(bubble);
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            return loadingId;
        }

        function removeLoadingIndicator(loadingId) {
            const element = document.getElementById(loadingId);
            if (element) element.remove();
        }

        function updateChecklist(checklistData) {
            const items = ['intro', 'brandedTracking', 'productFeed', 'assets', 'ipAddresses', 'trackingScripts'];
            let completed = 0;

            items.forEach(item => {
                const element = document.getElementById(`checklist-${item}`);
                if (checklistData[item]) {
                    element.querySelector('svg').innerHTML = `
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" fill="currentColor"/>
                    `;
                    element.querySelector('svg').classList.remove('text-gray-300');
                    element.querySelector('svg').classList.add('text-green-500');
                    element.querySelector('span').classList.remove('text-gray-500');
                    element.querySelector('span').classList.add('text-gray-700', 'font-medium');
                    completed++;
                }
            });

            const percentage = Math.round((completed / items.length) * 100);
            document.getElementById('progress-percentage').textContent = `${percentage}%`;
            document.getElementById('progress-bar').style.width = `${percentage}%`;
        }

        function updateDataSummary() {
            const summary = [];
            
            if (onboardingData.clientName) {
                summary.push(`<p><strong>Client:</strong> ${onboardingData.clientName}</p>`);
            }
            if (onboardingData.companyName) {
                summary.push(`<p><strong>Company:</strong> ${onboardingData.companyName}</p>`);
            }
            if (onboardingData.email) {
                summary.push(`<p><strong>Email:</strong> ${onboardingData.email}</p>`);
            }
            if (onboardingData.brandedTracking?.visit) {
                summary.push(`<p><strong>Visit:</strong> ${onboardingData.brandedTracking.visit} ${onboardingData.dnsVerified ? '‚úì' : ''}</p>`);
            }
            if (onboardingData.brandedTracking?.statics) {
                summary.push(`<p><strong>Statics:</strong> ${onboardingData.brandedTracking.statics} ${onboardingData.dnsVerified ? '‚úì' : ''}</p>`);
            }
            if (onboardingData.productFeedUrl) {
                summary.push(`<p><strong>Feed:</strong> ${onboardingData.productFeedUrl.substring(0, 30)}... ${onboardingData.feedProcessed ? '‚úì' : ''}</p>`);
            }
            if (onboardingData.feedProductCount) {
                summary.push(`<p><strong>Products:</strong> ${onboardingData.feedProductCount}</p>`);
            }
            if (onboardingData.officeIPs && onboardingData.officeIPs.length > 0) {
                summary.push(`<p><strong>IPs:</strong> ${onboardingData.officeIPs.length} address(es)</p>`);
            }
            if (onboardingData.filesUploaded) {
                summary.push(`<p class="text-green-600"><strong>‚úì Assets Uploaded</strong></p>`);
            }

            dataSummary.innerHTML = summary.length > 0 ? summary.join('') : '<p>No data collected yet</p>';
        }

        function showApiStatus(type, message) {
            apiStatus.className = `mb-6 p-3 rounded-lg ${type === 'success' ? 'bg-green-50 text-green-800' : 'bg-orange-50 text-orange-800'}`;
            apiStatusText.textContent = message;
            apiStatus.classList.remove('hidden');
            
            setTimeout(() => {
                apiStatus.classList.add('hidden');
            }, 5000);
        }
    </script>
</body>
</html>
